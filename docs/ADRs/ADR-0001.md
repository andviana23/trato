# ADR-0001: Escolha do Stack Tecnológico

## Status

**ACEITO** - Implementado em Dezembro 2024

## Contexto

O sistema Trato de Barbados precisava de uma arquitetura moderna, escalável e que permitisse desenvolvimento rápido para atender as necessidades de um negócio de barbearias multi-unidade.

### Requisitos Identificados:

- **Performance**: Interface responsiva para agendamentos em tempo real
- **Escalabilidade**: Suporte a múltiplas unidades e crescimento
- **Desenvolvimento Rápido**: Time pequeno precisava entregar funcionalidades rapidamente
- **Manutenibilidade**: Código limpo e fácil de manter
- **Integração**: Necessidade de webhooks e APIs externas (ASAAS)
- **Real-time**: Sistema de fila e notificações em tempo real

## Opções Consideradas

### Frontend Framework

#### Opção A: Next.js 15 + React 19

**Prós:**

- SSR/SSG nativo para SEO
- App Router com server components
- API Routes integradas
- Excelente DX com TypeScript
- Vercel deploy otimizado
- Grande comunidade

**Contras:**

- Curva de aprendizado do App Router
- Bundle size pode ser grande

#### Opção B: Remix

**Prós:**

- Foco em web standards
- Excelente handling de forms
- Performance otimizada

**Contras:**

- Comunidade menor
- Menos recursos prontos

#### Opção C: SvelteKit

**Prós:**

- Bundle size menor
- Performance excelente

**Contras:**

- Ecossistema menor
- Menos desenvolvedores disponíveis

### Backend Strategy

#### Opção A: Supabase (BaaS)

**Prós:**

- PostgreSQL managed
- Auth builtin
- RLS para multi-tenancy
- Real-time subscriptions
- API REST automática
- Desenvolvimento rápido

**Contras:**

- Vendor lock-in
- Menos controle sobre infraestrutura

#### Opção B: Node.js + Express + PostgreSQL

**Prós:**

- Controle total
- Flexibilidade máxima

**Contras:**

- Mais tempo de desenvolvimento
- Mais infraestrutura para gerenciar

#### Opção C: Prisma + Railway/PlanetScale

**Prós:**

- ORM type-safe
- Migrações automáticas

**Contras:**

- Complexidade adicional
- Custos maiores

### UI Framework

#### Opção A: Chakra UI 3

**Prós:**

- Design system completo
- Acessibilidade builtin
- TypeScript first
- Componentes composáveis
- Theme system robusto

**Contras:**

- Bundle size
- Menos customização visual

#### Opção B: Tailwind + shadcn/ui

**Prós:**

- Máxima flexibilidade
- Bundle otimizado
- Design custom

**Contras:**

- Mais código para escrever
- Consistência manual

#### Opção C: Material-UI

**Prós:**

- Muito maduro
- Componentes ricos

**Contras:**

- Opinionated demais
- Difícil customização

## Decisão

### Stack Escolhido:

- **Frontend**: Next.js 15 + React 19 + TypeScript 5
- **Backend**: Supabase (PostgreSQL + Auth + Real-time)
- **UI**: Chakra UI 3 + Tailwind CSS (utilities)
- **Forms**: React Hook Form + Zod
- **Date**: Day.js
- **Charts**: Chart.js + Recharts
- **DnD**: DnD Kit
- **Deploy**: Vercel

## Justificativa

### Next.js 15 + React 19

- **App Router** permitiu structure clara com layouts aninhados
- **Server Actions** simplificaram forms e mutations
- **TypeScript** garantiu type safety em todo código
- **Vercel deploy** zero-config com preview deployments

### Supabase

- **RLS** resolveu multi-tenancy elegantemente
- **Real-time** permitiu fila de atendimento ao vivo
- **Auth** pronto eliminando semanas de desenvolvimento
- **PostgreSQL** atendeu necessidades relacionais complexas
- **API automática** acelerou desenvolvimento

### Chakra UI 3

- **Design System** garantiu consistência visual
- **Acessibilidade** builtin foi crucial para barbearia
- **TypeScript** integration perfeita
- **Theme tokens** permitiram multi-brand (Trato/BarberBeer)

## Consequências

### Positivas

✅ **Desenvolvimento 3x mais rápido** que stack tradicional  
✅ **Type safety** end-to-end preveniu bugs  
✅ **Real-time** funcionou out-of-the-box  
✅ **Deploy** automático sem DevOps  
✅ **Scaling** automático no Supabase  
✅ **DX** excelente com hot reload e error messages

### Negativas

⚠️ **Vendor lock-in** com Supabase  
⚠️ **Bundle size** maior que necessário  
⚠️ **Learning curve** do App Router  
⚠️ **Debugging** mais complexo com server components

### Mitigações Implementadas

- **Abstração de services** para facilitar migração futura
- **Code splitting** para reduzir bundle inicial
- **Error boundaries** para melhor debugging
- **Types compartilhados** entre client/server

## Histórico de Revisões

| Data     | Mudança         | Motivo            |
| -------- | --------------- | ----------------- |
| Dez 2024 | Decisão inicial | Início do projeto |
| -        | -               | -                 |

## Próximas Revisões

- **Q1 2025**: Avaliar performance com dados reais
- **Q2 2025**: Considerar migration para self-hosted se scaling issues
- **Q3 2025**: Avaliar React 20 quando disponível

---

**Decisor**: Time de Desenvolvimento  
**Stakeholders**: Product Owner, Tech Lead  
**Impacto**: Alto - Define toda arquitetura base
